07:14:00 [INFO] Start
07:14:00 [INFO] ==================================================================
07:14:00 [INFO] Config - pretrain:
# Pretrain file num
PRETRAIN_FILE_NUM = 20
LOAD_DATA_TYPE = 'mem'#'fluid'
# Training params
NUM_FOLDS = 1
SEED = 2021
BATCH_SIZE = 128
NUM_EPOCHS = 40
WARMUP_RATIO = 0.06
REINIT_LAYER = 0
WEIGHT_DECAY = 0.01
LR = {'others':5e-4, 'roberta':5e-5, 'newfc_videoreg':5e-4}
LR_LAYER_DECAY = 1.0
PRETRAIN_TASK = ['tag', 'mlm', 'mfm']
07:14:00 [INFO] ==================================================================
07:14:00 [INFO] Config - model:
MODEL_TYPE = 'uni'#'all', 'cross', 'frame', 'bi', 'uni'

MODEL_CONFIG = {
    'INPUT_SIZE': 1792,
    'HIDDEN_SIZE': 256,
    'NUM_CLASSES': 10000,
    'FEATURE_SIZE': 1536,
    'OUTPUT_SIZE': 1024,
    'EXPANSION_SIZE': 2,
    'CLUSTER_SIZE': 64,
    'NUM_GROUPS': 8,
    'DROPOUT_PROB': 0.2,
}

BERT_CFG_DICT = {}
BERT_CFG_DICT['uni'] = {
    'hidden_size':768,
    'num_hidden_layers':6,
    'num_attention_heads':12,
    'intermediate_size':3072,
    'hidden_dropout_prob':0.0,
    'attention_probs_dropout_prob':0.0
}
07:14:00 [INFO] ==================================================================
07:14:00 [INFO] Config - data:
DATA_PATH = '../input/data'
BERT_PATH = '../input/pretrain-model/roberta-wwm-large'

DESC = {
    'tag_id':"int",
    'id': 'byte',
    'category_id': 'int',
    'title': 'byte',
    'asr_text': 'byte',
    'frame_feature': 'bytes'
}

DESC_NOTAG = {
    'id': 'byte',
    'title': 'byte',
    'asr_text': 'byte',
    'frame_feature': 'bytes'
}
07:14:00 [INFO] Model_type = uni
07:14:00 [INFO] ==================================================================
07:14:00 [INFO] Fold=1/1 seed=2021
07:14:00 [INFO] Load data into memory
07:20:15 [INFO] Dataset used memory = 56.2GB
07:20:15 [INFO] Total train steps=312500, warmup steps=18750
07:23:24 [INFO] Epoch=1/40|step= 20|val_acc=2.345e-06|time=12.0s|New best_acc=2.345e-06
07:29:28 [INFO] Epoch=1/40|step=500|val_acc=5.893e-07|time=1.92e+02s|New best_acc=5.893e-07
07:35:38 [INFO] Epoch=1/40|step=1000|val_acc=0.00271|time=2.01e+02s|New best_acc=0.00271
07:41:50 [INFO] Epoch=1/40|step=1500|val_acc=0.006918|time=2.01e+02s|New best_acc=0.006918
07:47:55 [INFO] Epoch=1/40|step=2000|val_acc=0.007476|time=2.02e+02s|New best_acc=0.007476
07:54:00 [INFO] Epoch=1/40|step=2500|val_acc=0.008323|time=2.01e+02s|New best_acc=0.008323
08:00:04 [INFO] Epoch=1/40|step=3000|val_acc=0.01092|time=2.01e+02s|New best_acc=0.01092
08:06:09 [INFO] Epoch=1/40|step=3500|val_acc=0.02539|time=2.02e+02s|New best_acc=0.02539
08:12:15 [INFO] Epoch=1/40|step=4000|val_acc=0.03781|time=2.01e+02s|New best_acc=0.03781
08:18:17 [INFO] Epoch=1/40|step=4500|val_acc=0.07533|time=2.01e+02s|New best_acc=0.07533
08:24:20 [INFO] Epoch=1/40|step=5000|val_acc=0.1354|time=2.02e+02s|New best_acc=0.1354
08:30:23 [INFO] Epoch=1/40|step=5500|val_acc=0.2016|time=2.01e+02s|New best_acc=0.2016
08:36:27 [INFO] Epoch=1/40|step=6000|val_acc= 0.251|time=2.02e+02s|New best_acc= 0.251
08:42:29 [INFO] Epoch=1/40|step=6500|val_acc=0.2983|time=2.01e+02s|New best_acc=0.2983
08:48:30 [INFO] Epoch=1/40|step=7000|val_acc=0.3313|time=2.01e+02s|New best_acc=0.3313
08:54:33 [INFO] Epoch=1/40|step=7500|val_acc=0.3572|time=2.01e+02s|New best_acc=0.3572
